"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[1999],{217:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>u,contentTitle:()=>l,default:()=>i,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"web/ssr/createBundleRenderer","title":"createBundleRenderer","description":"createBundleRenderer \u662f Vue.js \u670d\u52a1\u7aef\u6e32\u67d3\uff08SSR\uff09\u7684\u4e00\u4e2a\u9ad8\u7ea7\u529f\u80fd\uff0c\u5b83\u7531 vue-server-renderer \u5305\u63d0\u4f9b\u3002\u8fd9\u4e2a\u529f\u80fd\u4e3b\u8981\u7528\u4e8e\u5904\u7406\u548c\u6e32\u67d3\u7531 webpack \u6253\u5305\u7684 Vue \u5e94\u7528\u4ee3\u7801\u3002\u4f7f\u7528 createBundleRenderer \u53ef\u4ee5\u63d0\u9ad8\u6e32\u67d3\u6027\u80fd\uff0c\u540c\u65f6\u7b80\u5316\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u6570\u636e\u5904\u7406\u548c\u7ec4\u4ef6\u7f13\u5b58\u7b56\u7565\u3002","source":"@site/markdown/web/14.ssr/03.createBundleRenderer.md","sourceDirName":"web/14.ssr","slug":"/web/ssr/createBundleRenderer","permalink":"/docs/docs/web/ssr/createBundleRenderer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"createRenderer","permalink":"/docs/docs/web/ssr/createRender"},"next":{"title":"nuxt \u6267\u884c\u8fc7\u7a0b","permalink":"/docs/docs/web/ssr/nuxt\u6267\u884c\u8fc7\u7a0b"}}');var s=n(4848),d=n(8453);const c={},l="createBundleRenderer",u={},a=[{value:"\u5de5\u4f5c\u539f\u7406",id:"\u5de5\u4f5c\u539f\u7406",level:2},{value:"\u5173\u952e\u7279\u6027",id:"\u5173\u952e\u7279\u6027",level:2},{value:"\u4f7f\u7528 createBundleRenderer",id:"\u4f7f\u7528-createbundlerenderer",level:2}];function o(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"createbundlerenderer",children:"createBundleRenderer"})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"createBundleRenderer \u662f Vue.js \u670d\u52a1\u7aef\u6e32\u67d3\uff08SSR\uff09\u7684\u4e00\u4e2a\u9ad8\u7ea7\u529f\u80fd\uff0c\u5b83\u7531 vue-server-renderer \u5305\u63d0\u4f9b\u3002\u8fd9\u4e2a\u529f\u80fd\u4e3b\u8981\u7528\u4e8e\u5904\u7406\u548c\u6e32\u67d3\u7531 webpack \u6253\u5305\u7684 Vue \u5e94\u7528\u4ee3\u7801\u3002\u4f7f\u7528 createBundleRenderer \u53ef\u4ee5\u63d0\u9ad8\u6e32\u67d3\u6027\u80fd\uff0c\u540c\u65f6\u7b80\u5316\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u6570\u636e\u5904\u7406\u548c\u7ec4\u4ef6\u7f13\u5b58\u7b56\u7565\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u5de5\u4f5c\u539f\u7406",children:"\u5de5\u4f5c\u539f\u7406"}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"createBundleRenderer \u5141\u8bb8\u4f60\u76f4\u63a5\u6e32\u67d3 Vue \u5e94\u7528\u7684\u670d\u52a1\u5668\u7aef\u6253\u5305\u6587\u4ef6\uff08\u901a\u5e38\u662f\u901a\u8fc7 webpack \u548c vue-server-renderer/server-plugin \u63d2\u4ef6\u751f\u6210\u7684 bundle \u6587\u4ef6\uff09\u3002\u8fd9\u4e2a\u6253\u5305\u6587\u4ef6\u63cf\u8ff0\u4e86\u6574\u4e2a Vue \u5e94\u7528\u7684\u7ed3\u6784\u548c\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f7f\u5f97 Vue \u670d\u52a1\u5668\u7aef\u6e32\u67d3\u5668\u53ef\u4ee5\u66f4\u9ad8\u6548\u5730\u89e3\u6790\u548c\u6e32\u67d3\u5e94\u7528\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u5173\u952e\u7279\u6027",children:"\u5173\u952e\u7279\u6027"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u6e90\u7801\u6620\u5c04\u652f\u6301\uff1a\u63d0\u4f9b\u4e86\u5bf9 JavaScript \u6e90\u7801\u6620\u5c04\uff08Source Map\uff09\u7684\u652f\u6301\uff0c\u6709\u52a9\u4e8e\u5728\u670d\u52a1\u7aef\u6e32\u67d3\u8fc7\u7a0b\u4e2d\u7684\u8c03\u8bd5\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u81ea\u52a8\u4ee3\u7801\u5206\u5272\uff1a\u5728\u6253\u5305\u8fc7\u7a0b\u4e2d\uff0cwebpack \u4f1a\u6839\u636e\u9700\u8981\u5c06\u5e94\u7528\u4ee3\u7801\u5206\u5272\u6210\u591a\u4e2a chunk\uff0ccreateBundleRenderer \u80fd\u591f\u5904\u7406\u8fd9\u4e9b\u5f02\u6b65\u52a0\u8f7d\u7684 chunk\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u5185\u7f6e\u7ec4\u4ef6\u7f13\u5b58\uff1a\u63d0\u4f9b\u4e86\u7ec4\u4ef6\u7ea7\u522b\u7684\u7f13\u5b58\u7b56\u7565\uff0c\u4ee5\u63d0\u9ad8\u6e32\u67d3\u6027\u80fd\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u6d41\u5f0f\u6e32\u67d3\u652f\u6301\uff1a\u652f\u6301\u5c06\u6e32\u67d3\u7ed3\u679c\u4ee5\u6d41\u7684\u5f62\u5f0f\u53d1\u9001\u5230\u5ba2\u6237\u7aef\uff0c\u8fdb\u4e00\u6b65\u63d0\u9ad8\u5185\u5bb9\u5230\u8fbe\u65f6\u95f4\uff08Time to First Byte\uff0cTTFB\uff09\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u4f7f\u7528-createbundlerenderer",children:"\u4f7f\u7528 createBundleRenderer"}),"\n",(0,s.jsx)(r.p,{children:"\u5728\u4f7f\u7528 createBundleRenderer \u4e4b\u524d\uff0c\u4f60\u9700\u8981\u4f7f\u7528 webpack \u548c vue-server-renderer/server-plugin \u63d2\u4ef6\u5bf9 Vue \u5e94\u7528\u8fdb\u884c\u670d\u52a1\u5668\u7aef\u6253\u5305\u3002\u8fd9\u4f1a\u751f\u6210\u4e00\u4e2a .json \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5e94\u7528\u7684 bundle \u4fe1\u606f\u3002"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"const { createBundleRenderer } = require('vue-server-renderer')\nconst serverBundle = require('./dist/vue-ssr-server-bundle.json')\nconst renderer = createBundleRenderer(serverBundle, {\n  runInNewContext: false, // \u63a8\u8350\n  // template, // \u53ef\u9009\u7684 HTML \u6a21\u677f\n  // clientManifest // \u5ba2\u6237\u7aef\u6784\u5efa manifest\n})\n\n// \u5728\u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\u65f6\nserver.get('*', (req, res) => {\n  const context = { url: req.url }\n  renderer.renderToString(context, (err, html) => {\n    if (err) {\n      if (err.code === 404) {\n        res.status(404).end('Page not found')\n      } else {\n        res.status(500).end('Internal Server Error')\n      }\n      return\n    }\n    res.end(html)\n  })\n})\n"})})]})}function i(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>l});var t=n(6540);const s={},d=t.createContext(s);function c(e){const r=t.useContext(d);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(d.Provider,{value:r},e.children)}}}]);