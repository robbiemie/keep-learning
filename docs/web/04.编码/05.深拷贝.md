# 深拷贝

> 需要考虑环形依赖问题

```js
function cloneDeep(value) {
  function clone(target, map) {
    if(target === null) return null;
    if(typeof target === 'object') {
      let cloneTarget = Array.isArray(target) ? [] : {}
      if(map.get(target)) {
        return map.get(target);
      }
      map.set(target, cloneTarget);
      for(let key in target) {
        // 对象类型
        cloneTarget[key] = clone(target[key], map);
      }
      return cloneTarget;
    } else {
      // 基础类型
      return target
    }

  }

  return clone(value, new WeakMap())
}

let obj = {
  a: 1,
  b: {
    c: 2
  },
  d: [{e: '3'}, '4']
}
obj.e = obj

console.log(cloneDeep(obj));
```