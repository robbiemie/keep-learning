# 跨域

> 跨域（Cross-Origin）是指浏览器限制脚本在一个源（域名、协议、端口）下运行时，访问另一个源下的资源的行为。当浏览器发起跨域请求时，如果目标资源的域名、协议或端口与当前页面不同，浏览器会阻止该请求，以保护用户隐私和安全。

跨域问题的产生主要是因为浏览器的同源策略（Same-Origin Policy），同源策略规定了不同源之间的访问限制，包括 JavaScript 脚本的跨域请求、DOM 访问、Cookie 和 LocalStorage 的访问等。

解决跨域问题的常见方法包括：

1. JSONP（JSON with Padding）： JSONP 是一种利用 `<script>`标签进行跨域请求的技术。通过在请求 URL 中添加一个回调函数的参数，服务器返回的数据会被包裹在这个回调函数中，从而实现跨域访问。
2. CORS（Cross-Origin Resource Sharing）： CORS 是一种通过在服务器端设置响应头来允许跨域请求的标准方式。服务器可以通过设置 Access-Control-Allow-Origin、Access-Control-Allow-Methods、Access-Control-Allow-Headers 等头部字段来指定允许跨域访问的源、请求方法和请求头。
3. 代理： 在服务器端设置代理，将跨域请求转发到目标服务器并返回结果。前端向自己的服务器发送请求，服务器再向目标服务器发送请求，并将结果返回给前端，这样就避免了跨域问题。
4. WebSocket： WebSocket 是一种全双工通信协议，可以在客户端和服务器之间建立持久连接。由于 WebSocket 不受同源策略的限制，因此可以用于跨域通信。
5. 跨域资源共享（Cross-Origin Resource Sharing）： CORS 是一种通过在服务器端设置响应头来允许跨域请求的标准方式。服务器可以通过设置 Access-Control-Allow-Origin、Access-Control-Allow-Methods、Access-Control-Allow-Headers 等头部字段来指定允许跨域访问的源、请求方法和请求头。
6. 通过 img 标签跨域

## jsonp

1. 前端页面通过创建一个 `<script>` 标签，指向包含 JSON 数据的 URL，同时在 URL 中添加一个回调函数的参数，例如：

```js
<script src="http://example.com/data?callback=myCallback"></script>
```

2.服务器接收到请求后，解析 URL 中的参数，并将数据包裹在回调函数中返回给客户端，例如：

```java
myCallback({"name": "John", "age": 30});
```

3. 客户端定义一个全局的回调函数，以处理服务器返回的数据，例如：

```js
function myCallback(data) {
    console.log(data.name); // 输出 "John"
}
window.myCallback = myCallback
```

通过以上步骤，前端页面就可以通过 `<script>` 标签获取到跨域服务器返回的数据，并且利用全局的回调函数进行处理。

JSONP 的实现原理是利用了浏览器对 <script> 标签的加载不受同源策略限制的特性，从而实现跨域请求。不过需要注意的是，JSONP 只支持 GET 请求，并且由于是将数据作为 JavaScript 代码执行，存在安全风险，可能被恶意注入恶意代码，因此在使用时需要谨慎防范。




